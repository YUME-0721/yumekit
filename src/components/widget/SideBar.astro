---
import type { MarkdownHeading } from "astro";

import Profile from "./Profile.astro";
import Categories from "./Categories.astro";
import Tags from "./Tags.astro";
import TOC from "./TOC.astro";
import { siteConfig } from "../../config";

interface Props {
	class?: string;
	headings?: MarkdownHeading[];
}

const className = Astro.props.class;
const { headings = [] } = Astro.props;
const tocEnabled = siteConfig.toc.enable;
---
<div id="sidebar" class:list={[className, "w-full"]}>
    <div class="flex flex-col w-full gap-4 mb-4">
        <Profile></Profile>
        <Categories class="onload-animation"></Categories>
        <Tags class="onload-animation"></Tags>
    </div>
    <div id="sidebar-sticky" class="transition-all duration-700 flex flex-col w-full gap-4 sticky top-4">
        <!-- 目录容器（Swup 会替换此元素内容） -->
        <div id="toc-sidebar" class:list={["card-base p-4 max-h-[calc(100vh-8rem)] overflow-y-auto", {"hidden": !tocEnabled || headings.length === 0, "hidden lg:block": tocEnabled && headings.length > 0}]}>
            {tocEnabled && headings.length > 0 && (
                <>
                    <div class="text-sm font-medium text-black/60 dark:text-white/60 mb-2">目录</div>
                    <TOC headings={headings}></TOC>
                </>
            )}
        </div>
    </div>
</div>
